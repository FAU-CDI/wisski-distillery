{"mappings":"C,A,W,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,C,E,E,C,E,E,E,iB,A,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,O,C,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,I,C,E,O,C,E,E,O,E,E,O,A,C,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,Q,C,S,C,C,C,E,C,C,E,C,C,E,E,iB,C,G,E,S,I,E,E,SEqCO,eAAe,EAAW,CAAqB,EAEpD,OAAO,MAAM,IAAI,QAAQ,CAAC,EAAS,KACjC,AAAA,CAAA,EAAA,EAAA,WAAU,AAAV,EAAY,YAAa,CAAC,KAAK,SAAA,CAAU,GAAO,CAAE,CAChD,WAAY,EACZ,QAAS,CAAC,EAAkB,KAC1B,GAAI,CAAC,EAAS,CACZ,EAAO,AAAI,MAAM,GAAW,sBAC5B,MACF,CAEA,EAAQ,EAAM,IAAd,CACF,CACF,EACF,EACF,CD/CA,IAAM,EAAS,SAAS,cAAA,CAAe,UACjC,EAAO,SAAS,cAAA,CAAe,QAC/B,EAAM,SAAS,cAAA,CAAe,OAC9B,EAAqB,SAAS,cAAA,CAAe,sBAC7C,EAAwB,SAAS,cAAA,CAAe,yBAChD,EAAY,SAAS,cAAA,CAAe,aAG1C,EAAO,gBAAA,CAAiB,SAAU,AAAC,IACjC,EAAI,cAAJ,GAEA,IAAM,EAAgB,SAAS,aAAA,CAAc,gCACvC,EAAS,aAA0B,iBAAoB,EAAc,KAAA,CAAQ,GAEnF,AAAA,EAAU,CACR,KAAM,EAAK,KAAX,CACA,OAAQ,EACR,OAAQ,CAAE,IAAK,EAAI,KAAT,CAAgB,UAAW,EAAU,OAArB,CAA8B,mBAAoB,EAAmB,OAAvC,CAAgD,sBAAuB,EAAsB,KAA7C,AAAmD,CAC7J,GACG,IAAA,CAAK,AAAA,IACJ,SAAS,IAAA,CAAO,mBAAqB,CACvC,GACC,KAAA,CAAM,AAAC,IAAQ,QAAQ,KAAA,CAAM,GAAI,SAAS,MAAT,EAAkB,EACxD,GAGA,EAAO,aAAA,CAAc,aAAa,gBAAgB,W","sources":["<anon>","src/entry/AdminProvision/index.ts","src/lib/remote/api.ts"],"sourcesContent":["(function () {\nvar $parcel$global =\ntypeof globalThis !== 'undefined'\n  ? globalThis\n  : typeof self !== 'undefined'\n  ? self\n  : typeof window !== 'undefined'\n  ? window\n  : typeof global !== 'undefined'\n  ? global\n  : {};\nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequireafa4\"];\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequireafa4\"] = parcelRequire;\n}\nparcelRequire(\"1cn8L\");\n\n\nvar $ceWIN = parcelRequire(\"ceWIN\");\nasync function $c6b25449aeade325$export$2d2c3bf7a4025be2(slug, system) {\n    return await new Promise((resolve, reject)=>{\n        (0, $ceWIN.createModal)(\"rebuild\", [\n            slug,\n            JSON.stringify(system)\n        ], {\n            bufferSize: 0,\n            onClose: (success, message)=>{\n                if (!success) {\n                    reject(new Error(message ?? \"unspecified error\"));\n                    return;\n                }\n                resolve(slug);\n            }\n        });\n    });\n}\nasync function $c6b25449aeade325$export$3cda1ff378df5b65(flags) {\n    // open a modal to provision a new instance\n    return await new Promise((resolve, reject)=>{\n        (0, $ceWIN.createModal)(\"provision\", [\n            JSON.stringify(flags)\n        ], {\n            bufferSize: 0,\n            onClose: (success, message)=>{\n                if (!success) {\n                    reject(new Error(message ?? \"unspecified error\"));\n                    return;\n                }\n                resolve(flags.Slug);\n            }\n        });\n    });\n}\n\n\nconst $26f06a6ff7eb4de4$var$system = document.getElementById(\"system\");\nconst $26f06a6ff7eb4de4$var$slug = document.getElementById(\"slug\");\nconst $26f06a6ff7eb4de4$var$php = document.getElementById(\"php\");\nconst $26f06a6ff7eb4de4$var$opcacheDevelopment = document.getElementById(\"opcacheDevelopment\");\nconst $26f06a6ff7eb4de4$var$contentSecurityPolicy = document.getElementById(\"contentsecuritypolicy\");\nconst $26f06a6ff7eb4de4$var$iipserver = document.getElementById(\"iipserver\");\n// add an event handler to open the modal form!\n$26f06a6ff7eb4de4$var$system.addEventListener(\"submit\", (evt)=>{\n    evt.preventDefault();\n    const flavorElement = document.querySelector('input[name=\"flavor\"]:checked');\n    const flavor = flavorElement instanceof HTMLInputElement ? flavorElement.value : \"\";\n    (0, $c6b25449aeade325$export$3cda1ff378df5b65)({\n        Slug: $26f06a6ff7eb4de4$var$slug.value,\n        Flavor: flavor,\n        System: {\n            PHP: $26f06a6ff7eb4de4$var$php.value,\n            IIPServer: $26f06a6ff7eb4de4$var$iipserver.checked,\n            OpCacheDevelopment: $26f06a6ff7eb4de4$var$opcacheDevelopment.checked,\n            ContentSecurityPolicy: $26f06a6ff7eb4de4$var$contentSecurityPolicy.value\n        }\n    }).then((slug)=>{\n        location.href = \"/admin/instance/\" + slug;\n    }).catch((e)=>{\n        console.error(e);\n        location.reload();\n    });\n});\n// enable the form!\n$26f06a6ff7eb4de4$var$system.querySelector(\"fieldset\")?.removeAttribute(\"disabled\");\n\n})();\n//# sourceMappingURL=AdminProvision.5f2c7fe4.js.map\n","import '../Admin/index.ts'\nimport '../Admin/index.css'\n\nimport { Provision } from '~/src/lib/remote/api'\n\nconst system = document.getElementById('system') as HTMLFormElement\nconst slug = document.getElementById('slug') as HTMLInputElement\nconst php = document.getElementById('php') as HTMLSelectElement\nconst opcacheDevelopment = document.getElementById('opcacheDevelopment') as HTMLInputElement\nconst contentSecurityPolicy = document.getElementById('contentsecuritypolicy') as HTMLInputElement\nconst iipserver = document.getElementById('iipserver') as HTMLInputElement\n\n// add an event handler to open the modal form!\nsystem.addEventListener('submit', (evt) => {\n  evt.preventDefault()\n\n  const flavorElement = document.querySelector('input[name=\"flavor\"]:checked')\n  const flavor = (flavorElement instanceof HTMLInputElement) ? flavorElement.value : ''\n\n  Provision({\n    Slug: slug.value,\n    Flavor: flavor,\n    System: { PHP: php.value, IIPServer: iipserver.checked, OpCacheDevelopment: opcacheDevelopment.checked, ContentSecurityPolicy: contentSecurityPolicy.value }\n  })\n    .then(slug => {\n      location.href = '/admin/instance/' + slug\n    })\n    .catch((e) => { console.error(e); location.reload() })\n})\n\n// enable the form!\nsystem.querySelector('fieldset')?.removeAttribute('disabled')\n","import { createModal } from '~/src/lib/remote'\n\n/**\n * Flags to provision a new system.\n * Should mirror \"provision\".Flags.\n */\ninterface ProvisionFlags {\n  Slug: string\n  Flavor?: string\n  System: System\n}\n\ninterface System {\n  PHP: string\n  IIPServer: boolean\n  OpCacheDevelopment: boolean\n  ContentSecurityPolicy: string\n}\n\n/** Rebuild the specified instance */\nexport async function Rebuild (slug: string, system: System): Promise<string> {\n  return await new Promise((resolve, reject) => {\n    createModal('rebuild', [slug, JSON.stringify(system)], {\n      bufferSize: 0,\n      onClose: (success: boolean, message?: string) => {\n        if (!success) {\n          reject(new Error(message ?? 'unspecified error'))\n          return\n        }\n\n        resolve(slug)\n      }\n    })\n  })\n}\n\n/** Provision provisions a new instance */\nexport async function Provision (flags: ProvisionFlags): Promise<string> {\n  // open a modal to provision a new instance\n  return await new Promise((resolve, reject) => {\n    createModal('provision', [JSON.stringify(flags)], {\n      bufferSize: 0,\n      onClose: (success: boolean, message?: string) => {\n        if (!success) {\n          reject(new Error(message ?? 'unspecified error'))\n          return\n        }\n\n        resolve(flags.Slug)\n      }\n    })\n  })\n}\n"],"names":["$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$ceWIN","$c6b25449aeade325$export$3cda1ff378df5b65","flags","Promise","resolve","reject","createModal","JSON","stringify","bufferSize","onClose","success","message","Slug","$26f06a6ff7eb4de4$var$system","document","getElementById","$26f06a6ff7eb4de4$var$slug","$26f06a6ff7eb4de4$var$php","$26f06a6ff7eb4de4$var$opcacheDevelopment","$26f06a6ff7eb4de4$var$contentSecurityPolicy","$26f06a6ff7eb4de4$var$iipserver","addEventListener","evt","preventDefault","flavorElement","querySelector","flavor","HTMLInputElement","value","Flavor","System","PHP","IIPServer","checked","OpCacheDevelopment","ContentSecurityPolicy","then","slug","location","href","catch","e","console","error","reload","removeAttribute"],"version":3,"file":"AdminProvision.5f2c7fe4.js.map","sourceRoot":"../"}