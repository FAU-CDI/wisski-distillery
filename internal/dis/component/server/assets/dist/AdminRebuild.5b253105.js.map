{"mappings":"A,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,C,E,E,C,E,E,E,iB,A,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,O,C,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,I,C,E,O,C,E,E,O,E,E,O,A,C,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,Q,C,S,C,C,C,E,C,C,E,C,C,E,E,iB,C,G,E,S,I,E,E,SEoBO,eAAe,EAAS,CAAY,CAAE,CAAc,EACzD,OAAO,MAAM,IAAI,QAAQ,CAAC,EAAS,KACjC,AAAA,CAAA,EAAA,EAAA,WAAU,AAAV,EAAY,UAAW,CAAC,EAAM,KAAK,SAAA,CAAU,GAAQ,CAAE,CACrD,WAAY,EACZ,QAAS,CAAC,EAAkB,KAC1B,GAAI,CAAC,EAAS,CACZ,EAAO,AAAI,MAAM,GAAW,sBAC5B,MACF,CAEA,EAAQ,EACV,CACF,EACF,EACF,CD7BA,MAAM,EAAS,SAAS,cAAA,CAAe,UACjC,EAAO,SAAS,cAAA,CAAe,QAC/B,EAAM,SAAS,cAAA,CAAe,OAC9B,EAAqB,SAAS,cAAA,CAAe,sBAC7C,EAAwB,SAAS,cAAA,CAAe,yBAChD,EAAY,SAAS,cAAA,CAAe,aAG1C,EAAO,gBAAA,CAAiB,SAAU,AAAC,IACjC,EAAI,cAAJ,GAEA,AAAA,EAAQ,EAAK,KAAA,CAAO,CAAE,IAAK,EAAI,KAAT,CAAgB,UAAW,EAAU,OAArB,CAA8B,mBAAoB,EAAmB,OAAvC,CAAgD,sBAAuB,EAAsB,KAA7C,AAAmD,GACpK,IAAA,CAAK,AAAA,IACJ,SAAS,IAAA,CAAO,mBAAqB,CACvC,GACC,KAAA,CAAM,AAAC,IAAQ,QAAQ,KAAA,CAAM,GAAI,SAAS,MAAT,EAAkB,EACxD,GAGA,EAAO,aAAA,CAAc,aAAa,gBAAgB","sources":["<anon>","src/entry/AdminRebuild/index.ts","src/lib/remote/api.ts"],"sourcesContent":["var $parcel$global =\ntypeof globalThis !== 'undefined'\n  ? globalThis\n  : typeof self !== 'undefined'\n  ? self\n  : typeof window !== 'undefined'\n  ? window\n  : typeof global !== 'undefined'\n  ? global\n  : {};\nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequireafa4\"];\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequireafa4\"] = parcelRequire;\n}\nparcelRequire(\"jq6PZ\");\n\n\nvar $aYOJS = parcelRequire(\"aYOJS\");\nasync function $b511defed11aa71b$export$2d2c3bf7a4025be2(slug, system) {\n    return await new Promise((resolve, reject)=>{\n        (0, $aYOJS.createModal)(\"rebuild\", [\n            slug,\n            JSON.stringify(system)\n        ], {\n            bufferSize: 0,\n            onClose: (success, message)=>{\n                if (!success) {\n                    reject(new Error(message ?? \"unspecified error\"));\n                    return;\n                }\n                resolve(slug);\n            }\n        });\n    });\n}\nasync function $b511defed11aa71b$export$3cda1ff378df5b65(flags) {\n    // open a modal to provision a new instance\n    return await new Promise((resolve, reject)=>{\n        (0, $aYOJS.createModal)(\"provision\", [\n            JSON.stringify(flags)\n        ], {\n            bufferSize: 0,\n            onClose: (success, message)=>{\n                if (!success) {\n                    reject(new Error(message ?? \"unspecified error\"));\n                    return;\n                }\n                resolve(flags.Slug);\n            }\n        });\n    });\n}\n\n\nconst $059f402914224e9d$var$system = document.getElementById(\"system\");\nconst $059f402914224e9d$var$slug = document.getElementById(\"slug\");\nconst $059f402914224e9d$var$php = document.getElementById(\"php\");\nconst $059f402914224e9d$var$opcacheDevelopment = document.getElementById(\"opcacheDevelopment\");\nconst $059f402914224e9d$var$contentSecurityPolicy = document.getElementById(\"contentsecuritypolicy\");\nconst $059f402914224e9d$var$iipserver = document.getElementById(\"iipserver\");\n// add an event handler to open the modal form!\n$059f402914224e9d$var$system.addEventListener(\"submit\", (evt)=>{\n    evt.preventDefault();\n    (0, $b511defed11aa71b$export$2d2c3bf7a4025be2)($059f402914224e9d$var$slug.value, {\n        PHP: $059f402914224e9d$var$php.value,\n        IIPServer: $059f402914224e9d$var$iipserver.checked,\n        OpCacheDevelopment: $059f402914224e9d$var$opcacheDevelopment.checked,\n        ContentSecurityPolicy: $059f402914224e9d$var$contentSecurityPolicy.value\n    }).then((slug)=>{\n        location.href = \"/admin/instance/\" + slug;\n    }).catch((e)=>{\n        console.error(e);\n        location.reload();\n    });\n});\n// enable the form!\n$059f402914224e9d$var$system.querySelector(\"fieldset\")?.removeAttribute(\"disabled\");\n\n\n//# sourceMappingURL=AdminRebuild.5b253105.js.map\n","import '../Admin/index.ts'\nimport '../Admin/index.css'\n\nimport { Rebuild } from '~/src/lib/remote/api'\n\nconst system = document.getElementById('system') as HTMLFormElement\nconst slug = document.getElementById('slug') as HTMLInputElement\nconst php = document.getElementById('php') as HTMLSelectElement\nconst opcacheDevelopment = document.getElementById('opcacheDevelopment') as HTMLInputElement\nconst contentSecurityPolicy = document.getElementById('contentsecuritypolicy') as HTMLInputElement\nconst iipserver = document.getElementById('iipserver') as HTMLInputElement\n\n// add an event handler to open the modal form!\nsystem.addEventListener('submit', (evt) => {\n  evt.preventDefault()\n\n  Rebuild(slug.value, { PHP: php.value, IIPServer: iipserver.checked, OpCacheDevelopment: opcacheDevelopment.checked, ContentSecurityPolicy: contentSecurityPolicy.value })\n    .then(slug => {\n      location.href = '/admin/instance/' + slug\n    })\n    .catch((e) => { console.error(e); location.reload() })\n})\n\n// enable the form!\nsystem.querySelector('fieldset')?.removeAttribute('disabled')\n","import { createModal } from '~/src/lib/remote'\n\n/**\n * Flags to provision a new system.\n * Should mirror \"provision\".Flags.\n */\ninterface ProvisionFlags {\n  Slug: string\n  Flavor?: string\n  System: System\n}\n\ninterface System {\n  PHP: string\n  IIPServer: boolean\n  OpCacheDevelopment: boolean\n  ContentSecurityPolicy: string\n}\n\n/** Rebuild the specified instance */\nexport async function Rebuild (slug: string, system: System): Promise<string> {\n  return await new Promise((resolve, reject) => {\n    createModal('rebuild', [slug, JSON.stringify(system)], {\n      bufferSize: 0,\n      onClose: (success: boolean, message?: string) => {\n        if (!success) {\n          reject(new Error(message ?? 'unspecified error'))\n          return\n        }\n\n        resolve(slug)\n      }\n    })\n  })\n}\n\n/** Provision provisions a new instance */\nexport async function Provision (flags: ProvisionFlags): Promise<string> {\n  // open a modal to provision a new instance\n  return await new Promise((resolve, reject) => {\n    createModal('provision', [JSON.stringify(flags)], {\n      bufferSize: 0,\n      onClose: (success: boolean, message?: string) => {\n        if (!success) {\n          reject(new Error(message ?? 'unspecified error'))\n          return\n        }\n\n        resolve(flags.Slug)\n      }\n    })\n  })\n}\n"],"names":["$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$aYOJS","$b511defed11aa71b$export$2d2c3bf7a4025be2","slug","system","Promise","resolve","reject","createModal","JSON","stringify","bufferSize","onClose","success","message","$059f402914224e9d$var$system","document","getElementById","$059f402914224e9d$var$slug","$059f402914224e9d$var$php","$059f402914224e9d$var$opcacheDevelopment","$059f402914224e9d$var$contentSecurityPolicy","$059f402914224e9d$var$iipserver","addEventListener","evt","preventDefault","value","PHP","IIPServer","checked","OpCacheDevelopment","ContentSecurityPolicy","then","location","href","catch","e","console","error","reload","querySelector","removeAttribute"],"version":3,"file":"AdminRebuild.5b253105.js.map","sourceRoot":"../"}